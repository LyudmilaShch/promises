<meta charset="UTF-8">
<script src="doAfter.js"></script>
<script src="axios.js"></script>
<script src="api.js"></script>
<script>
    // let myPromise = new Promise((resolve) => {
    //     setTimeout(() => {
    //         const randValue = Math.random()
    //         resolve(randValue)
    //     }, 2000)
    //     console.log(1)
    //     console.log(2)
    //     console.log(3)
    // }); //callback calls js
    //
    // myPromise.then((data) => {
    //     console.log("subscriber1: " + data);
    // })
    //
    // myPromise.then((data) => {
    //     console.log("subscriber2: " + data);
    // })


    //task 5
    /*    doAfter(15).then(() => console.log('I worked in 15 seconds'));
        doAfter(3).then(() => console.log('I worked in 3 seconds'));
        doAfter(10).then(() => console.log('I worked in 10 seconds'));*/

    //task 7
    // let promise3 = doAfter(3);
    // promise3.then( () => console.log('i worked in 3 seconds') );
    // promise3.then( () => console.log('and I also followed it up after 3 seconds') );
    // promise3.then( () => console.log('and me') );

    //task 9-11
    // doAfter(3)
    //     .then(() => console.log('My promise resolved'))
    //     .then(() => console.log('My promise resolved following pr1'));

    //task 12
    // let callback1 = () => {
    //     console.log('My promise resolved');
    //     return ('some text from pr1')
    // }
    // let callback2 = (data) => console.log('My promise resolved by this text: ' + data);
    //
    // let pr1 = doAfter(3);
    // let pr2 = pr1.then(callback1);
    // pr2.then(callback2);

    //task 14
    // let callback1 = () => {
    //     console.log('My promise resolved');
    //     return ('some text from pr1')
    // }
    // let callback2 = (data) => console.log('My promise resolved by this text: ' + data);
    //
    // let pr1 = doAfter(3)
    //     .then(() => {
    //         console.log('My promise resolved');
    //         return ('some text from pr1')
    //     })
    //     .then((data) => console.log('My promise resolved by this text: ' + data))

    //task 17
    // let pr1 = doAfter(4); // один промис
    // let pr2 = doAfter(7); // второй промис
    //
    // pr1.then(() => console.log("pr1 resolved")); // индивидуально подписываемся на каждый
    // pr2.then(() => console.log("pr2 resolved"));
    //
    // let aggregatedPromise = Promise.all([pr1, pr2]); // получаем общий промис
    //
    // aggregatedPromise.then(() => console.log("pr1 and pr2 resolved")); // сработает наш подписчик ТОЛЬКО когда все промисы, переданные в массиве в all будут resolved

    //task 18
    function getRandomAfter(sec) {
        return new Promise((resolve, reject) => {
            setTimeout(() => {
                const randValue = Math.random()
                resolve(randValue)
            }, sec * 1000)
        })
    }

    // getRandomAfter(4).then(number => console.log(`I dot a ${number} after 4 seconds`))
    //
    // let promises = [getRandomAfter(1),getRandomAfter(2), getRandomAfter(3)];
    // let commonPromise = Promise.all(promises);
    // commonPromise.then( (values) => {
    //     console.log(values)
    //     // как вывести здесь все 3 числа?? гуглим Promise.all
    // } );

    //task 19
    // let MicrosoftPromise = api.getVacanciesCountFromMicrosoft()
    // let GooglePromise = api.getVacanciesCountFromGoogle()
    //
    // MicrosoftPromise.then((res)=>console.log("microsoft has " + res.data.vacancies + " vacancy"))
    // GooglePromise.then((res)=>console.log("google has " + res.data.vacancies + " vacancy"))
    //
    // let aggregatedPromise = Promise.all([MicrosoftPromise, GooglePromise])
    // aggregatedPromise.then ((values) => {
    //     let resultFromMS = values[0].data.vacancies
    //     let resultFromG = values[1].data.vacancies
    //     api.sendStudentsCountToItKamasutra(resultFromMS + resultFromG)
    //         .then(result => {
    //             console.log(result.data.message + " " +result.data.requestedCount) ;
    //         });
    // })

    //dop to task 19
    // let MicrosoftPromise = api.getVacanciesCountFromMicrosoft()
    // let GooglePromise = api.getVacanciesCountFromGoogle()
    //
    // MicrosoftPromise.then((res)=>console.log(res))
    // GooglePromise.then((res)=>console.log(res))
    //
    // let aggregatedPromise = Promise.all([MicrosoftPromise, GooglePromise])
    // aggregatedPromise.then ((values) => {
    //     let resultFromMS = values[0]
    //     let resultFromG = values[1]
    //     api.sendStudentsCountToItKamasutra(resultFromMS + resultFromG)
    //         .then(result => {
    //             console.log(result.data.message + " " +result.data.requestedCount) ;
    //         });
    // })

    //dop
    // getRandomAfter(1)
    //     .then(rand1 => {
    //         console.log(rand1)
    //         return rand1
    //     })
    //     .then(rand1 => {
    //         console.log(rand1)
    //         return getRandomAfter(5)
    //     })
    //     .then(rand2 => {
    //         console.log(rand2)
    //         return rand2
    //     })
    //     .then(rand2 => console.log(rand2))


    //dop2 to task 19
    // let MicrosoftPromise = api.getVacanciesCountFromMicrosoft()
    // let GooglePromise = api.getVacanciesCountFromGoogle()
    //
    // MicrosoftPromise.then((res) => console.log(res))
    // GooglePromise.then((res) => console.log(res))
    //
    // let aggregatedPromise = Promise.all([MicrosoftPromise, GooglePromise])
    //
    // aggregatedPromise
    //     .then((values) => {
    //         let resultFromMS = values[0]
    //         let resultFromG = values[1]
    //         return api.sendStudentsCountToItKamasutra(resultFromMS + resultFromG)
    //     })
    //     .then(result => {
    //         console.log(result.data.message + " " + result.data.requestedCount);
    //     });


    //dop3 to task 19 consistently(последовательно)
    // let msVacancies;
    // api.getVacanciesCountFromMicrosoft()
    //     .then((msCount) => {
    //         console.log(msCount)
    //         msVacancies = msCount
    //         return  api.getVacanciesCountFromGoogle()
    //     })
    //     .then((gCount) => {
    //         console.log(gCount)
    //         return api.sendStudentsCountToItKamasutra(gCount + msVacancies)
    //     })
    //     .then(result => {
    //         console.log('from it: ' + result.data.requestedCount);
    //     });

    //task 21

    function loadVacanciesPromise() {
        let msVacancies;
        api.getVacanciesCountFromMicrosoft()
            .then((msCount) => {
                console.log(msCount)
                msVacancies = msCount
                return api.getVacanciesCountFromGoogle()
            })
            .then((gCount) => {
                console.log(gCount)
                return api.sendStudentsCountToItKamasutra(gCount + msVacancies)
            })
            .then(result => {
                console.log('from it: ' + result.data.requestedCount);
            });
    }

    async function loadVacanciesAsyncAwait() {
        let msCount = await api.getVacanciesCountFromMicrosoft()
        console.log(msCount)
        let gCount = await api.getVacanciesCountFromGoogle()
        console.log(gCount)
        let result = await api.sendStudentsCountToItKamasutra(gCount + msCount)
        console.log('from it: ' + result.data.requestedCount);
    }

    async function loadVacanciesAsyncAwaitParallel() {
        let msGResults = await Promise.all([
            api.getVacanciesCountFromMicrosoft(),
            api.getVacanciesCountFromGoogle()
        ])
        let result = await api.sendStudentsCountToItKamasutra(msGResults[0] + msGResults[1])
        console.log('from it: ' + result.data.requestedCount);
    }

    // loadVacanciesPromise()
    // loadVacanciesAsyncAwait()
    loadVacanciesAsyncAwaitParallel()

</script>
